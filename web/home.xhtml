<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <link href="css/stylesheet_3.css" rel="stylesheet" type="text/css" />
        <h1>
            <ui:insert name="header">
                Welcome #{user.get().login}!
            </ui:insert>
        </h1>
        <style>
            #div1 {
              width: 80px;
              height: 80px;
              padding: 10px;
              border: 1px solid #aaaaaa;
            }
            </style>

    </h:head>

    <body class="home-page">

        <div id="grid" class="grid-container" data-gridcolumns="#{user.get().gardenSize}" data-imgjson="#{util.getBoxesJson()}">
      </div>

      <script>
            document.body.onload = addElement;

            function addElement () {

                //Set # of columns
                const gridContainer = document.querySelector(".grid-container");
                const GRID_COLUMNS = gridContainer.dataset.gridcolumns;
                gridContainer.style.setProperty('--grid-columns', GRID_COLUMNS);

                //parse json for user's boxes
                //
                //generate grid off that json
                const json = JSON.parse(gridContainer.dataset.imgjson);
                let i;
                for (i = 0; i &lt; GRID_COLUMNS * GRID_COLUMNS; i++) {
                  const newDiv = document.createElement("div");
                  const id = i + 1;
//                  newDiv.textContent = id;
                  newDiv.dataset.id = id;
                  newDiv.dataset.plantid = json[id].plant_id;
                  newDiv.setAttribute('id', 'div1');
                  newDiv.setAttribute('class', 'grid-item');
                  newDiv.setAttribute('ondrop', 'drop(event)');
                  newDiv.setAttribute('ondragover', 'allowDrop(event)');

                  newDiv.onclick = () => {
                      console.log(newDiv.dataset.id + " was clicked on!:");
                      console.log(newDiv);
                  }


                  document.getElementById('grid').appendChild(newDiv);
                  //document.querySelector("[data-id=" + CSS.escape(id) + "]").appendChild(newImg);
                }

                //console.log(document.querySelector(".grid-container").dataset.imgjson);



            }
        </script>

        <script>
            function allowDrop(ev) {
              ev.preventDefault();
            }

            function drag(ev) {
              ev.dataTransfer.setData("text", ev.target.id);
            }

            function drop(ev) {
              ev.preventDefault();
              var data = ev.dataTransfer.getData("text");
              clone = document.getElementById(data).cloneNode(true);
              clone.id = "changed";
              ev.target.appendChild(clone);
            }
        </script>

        <img id="change" src="https://i.imgur.com/fJORZNV.png" draggable="true" ondragstart="drag(event)" width="80" height="80"></img>

        <script>
        function changeimage(color){

            switch(color){
                case "select":
                    document.getElementById("change").setAttribute('src', 'https://i.imgur.com/fJORZNV.png');
                 break;
                 case "red":
                    document.getElementById("change").setAttribute('src', '../assets/seeds_bag.jpg');
                 break;
                case "blue":
                    document.getElementById("change").setAttribute('src', '../assets/seeds_bag.jpg');
                 break;
                 case "green":
                    document.getElementById("change").setAttribute('src', '../assets/seeds_bag.jpg');
                 break;
            }
        }

        </script>

        <select onchange="changeimage(this.value)">
            <option value="select">select seed type</option>
            <option value="red">red</option>
            <option value="green">green</option>
            <option value="blue">blue</option>
        </select>

        <h:selectOneMenu value="#{seeds.getSeeds()}">
            <f:selectItems value="#{seeds.getSeeds()}" var="user" itemLabel="#{user.name}"/>
        </h:selectOneMenu>

        <table>
            <tr>
                <td><h:commandButton value="Select potato" styleClass="loginButton"/> </td>
                <td><h:form><h:commandButton value="Select seeds" styleClass="loginButton" action="#{seeds.showSeedInventory()}"/></h:form></td>
                <td><h:form><h:commandButton value="View crops" styleClass="loginButton" action="#{seeds.showSeedInventory()}"/></h:form></td>
            </tr>
        </table>
    </body>
</html>
