<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <link href="css/stylesheet_3.css" rel="stylesheet" type="text/css" />
        <h1>
            <ui:insert name="header">
                Welcome #{user.get().login}!
            </ui:insert>
        </h1>
        
    </h:head>
    
    <body class="home-page">
        
        <div id="grid" class="grid-container" data-gridcolumns="#{user.get().gardenSize}" data-imgjson="#{util.getBoxesJson()}">       
      </div>
        
      <script>
            document.body.onload = addElement;
                        
            function addElement () { 
                
                //Set # of columns              
                const gridContainer = document.querySelector(".grid-container");
                const GRID_COLUMNS = gridContainer.dataset.gridcolumns;
                gridContainer.style.setProperty('--grid-columns', GRID_COLUMNS);
                
                //parse json for user's boxes
                //
                //generate grid off that json
                var json = JSON.parse(gridContainer.dataset.imgjson);
                var i;
                for (i = 0; i &lt; GRID_COLUMNS * GRID_COLUMNS /* user boxes length */; i++) {
                  var newDiv = document.createElement("div"); 
                  const id = i + 1;
//                  newDiv.textContent = id;
                  newDiv.dataset.id = id;
                  newDiv.dataset.plantid = json[id].plant_id;
                  newDiv.setAttribute('class', 'grid-item');
                  
                  var newImg = document.createElement("img");
                  newImg.src = json[id].plant_url;
                  newImg.style.width = "40px";
                  newImg.style.height = "40px";

                  newDiv.onclick = e => {                   
                      console.log(e.target.dataset.id + " was clicked on!");
                  }
                  
                  
                  document.getElementById('grid').appendChild(newDiv);
                  document.querySelector("[data-id=" + CSS.escape(id) + "]").appendChild(newImg);
                }
                
                console.log(document.querySelector(".grid-container").dataset.imgjson);
                
                
                           
            }
        </script>
        
    </body>
</html>
